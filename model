# Zastąp "twoja_konekcja_bigquery" nazwą Twojego połączenia
connection: "twoja_konekcja_bigquery"

# Włącza mechanizm PDT i wskazuje domyślną datagroup
persist_with: audit_log_trigger

# Definicja Datagroup
datagroup: audit_log_trigger {
  label: "Trigger dla Logów Audytowych"
  description: "Uruchamia się co 5 min, aby sprawdzić, czy MAX(timestamp) 
                w tabeli źródłowej się zmienił (czyli czy wpadły nowe dane)."
                
  # To jest "czujnik" - gdy wynik tego zapytania się zmieni,
  # Looker uruchomi przebudowę PDT (w trybie przyrostowym).
  sql_trigger: SELECT MAX(timestamp) 
               FROM `twoj_projekt.twoj_dataset.twoja_tabela_zrodlowa` ;;

  # Jak długo dane w PDT są "świeże". Jeśli przez 24h nie wpadną
  # nowe dane, Looker i tak będzie używał starej wersji.
  max_cache_age: "24 hours"
}

# Dołączenie pliku widoku PDT
include: "/views/audit_log_pdt.view.lkml" # Upewnij się, że ścieżka się zgadza

# Definicja Explore, aby móc przetestować i przeglądać dane z PDT
explore: audit_log_pdt {
  label: "Test PDT - Logi Audytowe"
}
